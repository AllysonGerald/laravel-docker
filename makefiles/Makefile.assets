.PHONY: assets-install assets-build assets-dev assets-watch assets-clean assets-update assets-audit assets-check assets-prod assets-analyze assets-version assets-fix

##@ üé® Assets (Vite/Tailwind)

assets-install: ## Instala depend√™ncias NPM
	@echo "$(BLUE)üì¶ Instalando depend√™ncias NPM...$(NC)"
	@cd backend && npm install

assets-build: ## Compila assets para produ√ß√£o
	@echo "$(BLUE)üî® Compilando assets para produ√ß√£o...$(NC)"
	@cd backend && npm run build

assets-dev: ## Inicia servidor de desenvolvimento Vite
	@echo "$(BLUE)üöÄ Iniciando servidor Vite...$(NC)"
	@cd backend && npm run dev

assets-watch: assets-dev ## Alias para assets-dev

assets-clean: ## Remove node_modules e cache
	@echo "$(YELLOW)üßπ Limpando node_modules e cache...$(NC)"
	@cd backend && rm -rf node_modules package-lock.json .vite-temp public/build

assets-fresh: assets-clean assets-install assets-build ## Limpa, instala e compila assets

assets-update: ## Atualiza depend√™ncias NPM
	@echo "$(YELLOW)‚¨ÜÔ∏è  Atualizando depend√™ncias NPM...$(NC)"
	@cd backend && npm update

assets-audit: ## Audita depend√™ncias por vulnerabilidades
	@echo "$(YELLOW)üîç Verificando vulnerabilidades...$(NC)"
	@cd backend && npm audit

assets-audit-fix: ## Corrige vulnerabilidades automaticamente
	@echo "$(YELLOW)üîß Corrigindo vulnerabilidades...$(NC)"
	@cd backend && npm audit fix

assets-check: ## Verifica se h√° erros no c√≥digo
	@echo "$(BLUE)üîç Verificando c√≥digo...$(NC)"
	@cd backend && npm run build --dry-run 2>&1 || echo "$(YELLOW)‚ö†Ô∏è  Execute 'make assets-build' para ver erros completos$(NC)"

assets-prod: ## Build otimizado para produ√ß√£o
	@echo "$(GREEN)üöÄ Compilando para produ√ß√£o (otimizado)...$(NC)"
	@cd backend && NODE_ENV=production npm run build

assets-analyze: ## Analisa tamanho do bundle
	@echo "$(BLUE)üìä Analisando bundle...$(NC)"
	@cd backend && npm run build -- --mode analyze 2>&1 || echo "$(YELLOW)‚ö†Ô∏è  Adicione '--mode analyze' no vite.config.js para habilitar an√°lise$(NC)"

assets-version: ## Mostra vers√µes das depend√™ncias
	@echo "$(BLUE)üìã Vers√µes das depend√™ncias:$(NC)"
	@cd backend && npm list --depth=0 2>/dev/null || echo "$(YELLOW)‚ö†Ô∏è  Execute 'make assets-install' primeiro$(NC)"

assets-fix: ## Corrige problemas automaticamente (audit + update)
	@echo "$(YELLOW)üîß Corrigindo problemas...$(NC)"
	@cd backend && npm audit fix --force || true
	@cd backend && npm update
	@echo "$(GREEN)‚úÖ Corre√ß√µes aplicadas!$(NC)"

